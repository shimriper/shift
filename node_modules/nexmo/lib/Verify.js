"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _Utils = require("./Utils");

var _Utils2 = _interopRequireDefault(_Utils);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Verify = function () {
  _createClass(Verify, null, [{
    key: "PATH",
    get: function get() {
      return "/verify{action}/json";
    }
  }, {
    key: "ERROR_MESSAGES",
    get: function get() {
      return {
        verifyValidation: "Missing Mandatory fields (number and/or brand)",
        checkVerifyValidation: "Missing Mandatory fields (request_id and/or code)",
        controlVerifyValidation: "Missing Mandatory fields (request_id and/or cmd-command)",
        searchVerifyValidation: "Missing Mandatory fields (request_id or request_ids)"
      };
    }
    /**
     * @param {Credentials} credentials
     *    credentials to be used when interacting with the API.
     * @param {Object} options
     *    Addition Verify options.
     */

  }]);

  function Verify(credentials) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, Verify);

    this.creds = credentials;
    this.options = options;
  }

  /**
   * TODO: document
   */


  _createClass(Verify, [{
    key: "request",
    value: function request(inputParams, callback) {
      if (!inputParams.number || !inputParams.brand) {
        _Utils2.default.sendError(callback, new Error(Verify.ERROR_MESSAGES.verifyValidation));
      } else {
        inputParams["api_key"] = this.creds.apiKey;
        inputParams["api_secret"] = this.creds.apiSecret;
        this.options.httpClient.request({
          host: this.options.apiHost || "api.nexmo.com",
          path: _Utils2.default.createPathWithQuery("" + Verify.PATH.replace("{action}", ""), inputParams)
        }, callback);
      }
    }

    /**
     * TODO: document
     */

  }, {
    key: "check",
    value: function check(inputParams, callback) {
      if (!inputParams.request_id || !inputParams.code) {
        _Utils2.default.sendError(callback, new Error(Verify.ERROR_MESSAGES.checkVerifyValidation));
      } else {
        inputParams["api_key"] = this.creds.apiKey;
        inputParams["api_secret"] = this.creds.apiSecret;
        this.options.httpClient.request({
          host: this.options.apiHost || "api.nexmo.com",
          path: _Utils2.default.createPathWithQuery("" + Verify.PATH.replace("{action}", "/check"), inputParams)
        }, callback);
      }
    }

    /**
     * TODO: document
     */

  }, {
    key: "control",
    value: function control(inputParams, callback) {
      if (!inputParams.request_id || !inputParams.cmd) {
        _Utils2.default.sendError(callback, new Error(Verify.ERROR_MESSAGES.controlVerifyValidation));
      } else {
        inputParams["api_key"] = this.creds.apiKey;
        inputParams["api_secret"] = this.creds.apiSecret;
        this.options.httpClient.request({
          host: this.options.apiHost || "api.nexmo.com",
          path: _Utils2.default.createPathWithQuery("" + Verify.PATH.replace("{action}", "/control"), inputParams)
        }, callback);
      }
    }

    /**
     * TODO: document
     */

  }, {
    key: "search",
    value: function search(requestIds, callback) {
      var requestIdParam = {};
      if (!requestIds) {
        _Utils2.default.sendError(callback, new Error(Verify.ERROR_MESSAGES.searchVerifyValidation));
      } else {
        if (Array.isArray(requestIds)) {
          if (requestIds.length === 1) {
            requestIdParam.request_id = requestIds;
          } else {
            requestIdParam.request_ids = requestIds;
          }
        } else {
          requestIdParam.request_id = requestIds;
        }
        requestIdParam["api_key"] = this.creds.apiKey;
        requestIdParam["api_secret"] = this.creds.apiSecret;
        this.options.httpClient.request({
          host: this.options.apiHost || "api.nexmo.com",
          path: _Utils2.default.createPathWithQuery("" + Verify.PATH.replace("{action}", "/search"), requestIdParam)
        }, callback);
      }
    }
  }]);

  return Verify;
}();

exports.default = Verify;
module.exports = exports["default"];
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9WZXJpZnkuanMiXSwibmFtZXMiOlsiVmVyaWZ5IiwidmVyaWZ5VmFsaWRhdGlvbiIsImNoZWNrVmVyaWZ5VmFsaWRhdGlvbiIsImNvbnRyb2xWZXJpZnlWYWxpZGF0aW9uIiwic2VhcmNoVmVyaWZ5VmFsaWRhdGlvbiIsImNyZWRlbnRpYWxzIiwib3B0aW9ucyIsImNyZWRzIiwiaW5wdXRQYXJhbXMiLCJjYWxsYmFjayIsIm51bWJlciIsImJyYW5kIiwic2VuZEVycm9yIiwiRXJyb3IiLCJFUlJPUl9NRVNTQUdFUyIsImFwaUtleSIsImFwaVNlY3JldCIsImh0dHBDbGllbnQiLCJyZXF1ZXN0IiwiaG9zdCIsImFwaUhvc3QiLCJwYXRoIiwiY3JlYXRlUGF0aFdpdGhRdWVyeSIsIlBBVEgiLCJyZXBsYWNlIiwicmVxdWVzdF9pZCIsImNvZGUiLCJjbWQiLCJyZXF1ZXN0SWRzIiwicmVxdWVzdElkUGFyYW0iLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJyZXF1ZXN0X2lkcyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7O0FBRUE7Ozs7Ozs7O0lBRU1BLE07Ozt3QkFDYztBQUNoQixhQUFPLHNCQUFQO0FBQ0Q7Ozt3QkFFMkI7QUFDMUIsYUFBTztBQUNMQywwQkFBa0IsZ0RBRGI7QUFFTEMsK0JBQ0UsbURBSEc7QUFJTEMsaUNBQ0UsMERBTEc7QUFNTEMsZ0NBQ0U7QUFQRyxPQUFQO0FBU0Q7QUFDRDs7Ozs7Ozs7O0FBTUEsa0JBQVlDLFdBQVosRUFBdUM7QUFBQSxRQUFkQyxPQUFjLHVFQUFKLEVBQUk7O0FBQUE7O0FBQ3JDLFNBQUtDLEtBQUwsR0FBYUYsV0FBYjtBQUNBLFNBQUtDLE9BQUwsR0FBZUEsT0FBZjtBQUNEOztBQUVEOzs7Ozs7OzRCQUdRRSxXLEVBQWFDLFEsRUFBVTtBQUM3QixVQUFJLENBQUNELFlBQVlFLE1BQWIsSUFBdUIsQ0FBQ0YsWUFBWUcsS0FBeEMsRUFBK0M7QUFDN0Msd0JBQU1DLFNBQU4sQ0FDRUgsUUFERixF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NEIsS0FBS3RCLEtBQUwsQ0FBV1EsTUFBdkM7QUFDQWMsdUJBQWUsWUFBZixJQUErQixLQUFLdEIsS0FBTCxDQUFXUyxTQUExQztBQUNBLGFBQUtWLE9BQUwsQ0FBYVcsVUFBYixDQUF3QkMsT0FBeEIsQ0FDRTtBQUNFQyxnQkFBTSxLQUFLYixPQUFMLENBQWFjLE9BQWIsSUFBd0IsZUFEaEM7QUFFRUMsZ0JBQU0sZ0JBQU1DLG1CQUFOLE1BQ0R0QixPQUFPdUIsSUFBUCxDQUFZQyxPQUFaLENBQW9CLFVBQXBCLEVBQWdDLFNBQWhDLENBREMsRUFFSkssY0FGSTtBQUZSLFNBREYsRUFRRXBCLFFBUkY7QUFVRDtBQUNGOzs7Ozs7a0JBR1lULE0iLCJmaWxlIjoiVmVyaWZ5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCBVdGlscyBmcm9tIFwiLi9VdGlsc1wiO1xuXG5jbGFzcyBWZXJpZnkge1xuICBzdGF0aWMgZ2V0IFBBVEgoKSB7XG4gICAgcmV0dXJuIFwiL3ZlcmlmeXthY3Rpb259L2pzb25cIjtcbiAgfVxuXG4gIHN0YXRpYyBnZXQgRVJST1JfTUVTU0FHRVMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZlcmlmeVZhbGlkYXRpb246IFwiTWlzc2luZyBNYW5kYXRvcnkgZmllbGRzIChudW1iZXIgYW5kL29yIGJyYW5kKVwiLFxuICAgICAgY2hlY2tWZXJpZnlWYWxpZGF0aW9uOlxuICAgICAgICBcIk1pc3NpbmcgTWFuZGF0b3J5IGZpZWxkcyAocmVxdWVzdF9pZCBhbmQvb3IgY29kZSlcIixcbiAgICAgIGNvbnRyb2xWZXJpZnlWYWxpZGF0aW9uOlxuICAgICAgICBcIk1pc3NpbmcgTWFuZGF0b3J5IGZpZWxkcyAocmVxdWVzdF9pZCBhbmQvb3IgY21kLWNvbW1hbmQpXCIsXG4gICAgICBzZWFyY2hWZXJpZnlWYWxpZGF0aW9uOlxuICAgICAgICBcIk1pc3NpbmcgTWFuZGF0b3J5IGZpZWxkcyAocmVxdWVzdF9pZCBvciByZXF1ZXN0X2lkcylcIlxuICAgIH07XG4gIH1cbiAgLyoqXG4gICAqIEBwYXJhbSB7Q3JlZGVudGlhbHN9IGNyZWRlbnRpYWxzXG4gICAqICAgIGNyZWRlbnRpYWxzIHRvIGJlIHVzZWQgd2hlbiBpbnRlcmFjdGluZyB3aXRoIHRoZSBBUEkuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAqICAgIEFkZGl0aW9uIFZlcmlmeSBvcHRpb25zLlxuICAgKi9cbiAgY29uc3RydWN0b3IoY3JlZGVudGlhbHMsIG9wdGlvbnMgPSB7fSkge1xuICAgIHRoaXMuY3JlZHMgPSBjcmVkZW50aWFscztcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICB9XG5cbiAgLyoqXG4gICAqIFRPRE86IGRvY3VtZW50XG4gICAqL1xuICByZXF1ZXN0KGlucHV0UGFyYW1zLCBjYWxsYmFjaykge1xuICAgIGlmICghaW5wdXRQYXJhbXMubnVtYmVyIHx8ICFpbnB1dFBhcmFtcy5icmFuZCkge1xuICAgICAgVXRpbHMuc2VuZEVycm9yKFxuICAgICAgICBjYWxsYmFjayxcbiAgICAgICAgbmV3IEVycm9yKFZlcmlmeS5FUlJPUl9NRVNTQUdFUy52ZXJpZnlWYWxpZGF0aW9uKVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW5wdXRQYXJhbXNbXCJhcGlfa2V5XCJdID0gdGhpcy5jcmVkcy5hcGlLZXk7XG4gICAgICBpbnB1dFBhcmFtc1tcImFwaV9zZWNyZXRcIl0gPSB0aGlzLmNyZWRzLmFwaVNlY3JldDtcbiAgICAgIHRoaXMub3B0aW9ucy5odHRwQ2xpZW50LnJlcXVlc3QoXG4gICAgICAgIHtcbiAgICAgICAgICBob3N0OiB0aGlzLm9wdGlvbnMuYXBpSG9zdCB8fCBcImFwaS5uZXhtby5jb21cIixcbiAgICAgICAgICBwYXRoOiBVdGlscy5jcmVhdGVQYXRoV2l0aFF1ZXJ5KFxuICAgICAgICAgICAgYCR7VmVyaWZ5LlBBVEgucmVwbGFjZShcInthY3Rpb259XCIsIFwiXCIpfWAsXG4gICAgICAgICAgICBpbnB1dFBhcmFtc1xuICAgICAgICAgIClcbiAgICAgICAgfSxcbiAgICAgICAgY2FsbGJhY2tcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRPRE86IGRvY3VtZW50XG4gICAqL1xuICBjaGVjayhpbnB1dFBhcmFtcywgY2FsbGJhY2spIHtcbiAgICBpZiAoIWlucHV0UGFyYW1zLnJlcXVlc3RfaWQgfHwgIWlucHV0UGFyYW1zLmNvZGUpIHtcbiAgICAgIFV0aWxzLnNlbmRFcnJvcihcbiAgICAgICAgY2FsbGJhY2ssXG4gICAgICAgIG5ldyBFcnJvcihWZXJpZnkuRVJST1JfTUVTU0FHRVMuY2hlY2tWZXJpZnlWYWxpZGF0aW9uKVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW5wdXRQYXJhbXNbXCJhcGlfa2V5XCJdID0gdGhpcy5jcmVkcy5hcGlLZXk7XG4gICAgICBpbnB1dFBhcmFtc1tcImFwaV9zZWNyZXRcIl0gPSB0aGlzLmNyZWRzLmFwaVNlY3JldDtcbiAgICAgIHRoaXMub3B0aW9ucy5odHRwQ2xpZW50LnJlcXVlc3QoXG4gICAgICAgIHtcbiAgICAgICAgICBob3N0OiB0aGlzLm9wdGlvbnMuYXBpSG9zdCB8fCBcImFwaS5uZXhtby5jb21cIixcbiAgICAgICAgICBwYXRoOiBVdGlscy5jcmVhdGVQYXRoV2l0aFF1ZXJ5KFxuICAgICAgICAgICAgYCR7VmVyaWZ5LlBBVEgucmVwbGFjZShcInthY3Rpb259XCIsIFwiL2NoZWNrXCIpfWAsXG4gICAgICAgICAgICBpbnB1dFBhcmFtc1xuICAgICAgICAgIClcbiAgICAgICAgfSxcbiAgICAgICAgY2FsbGJhY2tcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRPRE86IGRvY3VtZW50XG4gICAqL1xuICBjb250cm9sKGlucHV0UGFyYW1zLCBjYWxsYmFjaykge1xuICAgIGlmICghaW5wdXRQYXJhbXMucmVxdWVzdF9pZCB8fCAhaW5wdXRQYXJhbXMuY21kKSB7XG4gICAgICBVdGlscy5zZW5kRXJyb3IoXG4gICAgICAgIGNhbGxiYWNrLFxuICAgICAgICBuZXcgRXJyb3IoVmVyaWZ5LkVSUk9SX01FU1NBR0VTLmNvbnRyb2xWZXJpZnlWYWxpZGF0aW9uKVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW5wdXRQYXJhbXNbXCJhcGlfa2V5XCJdID0gdGhpcy5jcmVkcy5hcGlLZXk7XG4gICAgICBpbnB1dFBhcmFtc1tcImFwaV9zZWNyZXRcIl0gPSB0aGlzLmNyZWRzLmFwaVNlY3JldDtcbiAgICAgIHRoaXMub3B0aW9ucy5odHRwQ2xpZW50LnJlcXVlc3QoXG4gICAgICAgIHtcbiAgICAgICAgICBob3N0OiB0aGlzLm9wdGlvbnMuYXBpSG9zdCB8fCBcImFwaS5uZXhtby5jb21cIixcbiAgICAgICAgICBwYXRoOiBVdGlscy5jcmVhdGVQYXRoV2l0aFF1ZXJ5KFxuICAgICAgICAgICAgYCR7VmVyaWZ5LlBBVEgucmVwbGFjZShcInthY3Rpb259XCIsIFwiL2NvbnRyb2xcIil9YCxcbiAgICAgICAgICAgIGlucHV0UGFyYW1zXG4gICAgICAgICAgKVxuICAgICAgICB9LFxuICAgICAgICBjYWxsYmFja1xuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVE9ETzogZG9jdW1lbnRcbiAgICovXG4gIHNlYXJjaChyZXF1ZXN0SWRzLCBjYWxsYmFjaykge1xuICAgIHZhciByZXF1ZXN0SWRQYXJhbSA9IHt9O1xuICAgIGlmICghcmVxdWVzdElkcykge1xuICAgICAgVXRpbHMuc2VuZEVycm9yKFxuICAgICAgICBjYWxsYmFjayxcbiAgICAgICAgbmV3IEVycm9yKFZlcmlmeS5FUlJPUl9NRVNTQUdFUy5zZWFyY2hWZXJpZnlWYWxpZGF0aW9uKVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmVxdWVzdElkcykpIHtcbiAgICAgICAgaWYgKHJlcXVlc3RJZHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgcmVxdWVzdElkUGFyYW0ucmVxdWVzdF9pZCA9IHJlcXVlc3RJZHM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVxdWVzdElkUGFyYW0ucmVxdWVzdF9pZHMgPSByZXF1ZXN0SWRzO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXF1ZXN0SWRQYXJhbS5yZXF1ZXN0X2lkID0gcmVxdWVzdElkcztcbiAgICAgIH1cbiAgICAgIHJlcXVlc3RJZFBhcmFtW1wiYXBpX2tleVwiXSA9IHRoaXMuY3JlZHMuYXBpS2V5O1xuICAgICAgcmVxdWVzdElkUGFyYW1bXCJhcGlfc2VjcmV0XCJdID0gdGhpcy5jcmVkcy5hcGlTZWNyZXQ7XG4gICAgICB0aGlzLm9wdGlvbnMuaHR0cENsaWVudC5yZXF1ZXN0KFxuICAgICAgICB7XG4gICAgICAgICAgaG9zdDogdGhpcy5vcHRpb25zLmFwaUhvc3QgfHwgXCJhcGkubmV4bW8uY29tXCIsXG4gICAgICAgICAgcGF0aDogVXRpbHMuY3JlYXRlUGF0aFdpdGhRdWVyeShcbiAgICAgICAgICAgIGAke1ZlcmlmeS5QQVRILnJlcGxhY2UoXCJ7YWN0aW9ufVwiLCBcIi9zZWFyY2hcIil9YCxcbiAgICAgICAgICAgIHJlcXVlc3RJZFBhcmFtXG4gICAgICAgICAgKVxuICAgICAgICB9LFxuICAgICAgICBjYWxsYmFja1xuICAgICAgKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVmVyaWZ5O1xuIl19